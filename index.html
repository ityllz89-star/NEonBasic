<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NeonBasic — Tiny BASIC Playground</title>
  <meta name="description" content="NeonBasic: dark neon playground with docs, live interpreter, save/share and wild animations." />

  <style>
    :root{
      --bg:#050505;
      --neon:#39ff14;
      --neon-2:#00ffa1;
      --muted:#7fcf7f;
      --card:#070b07;
      --glass:rgba(255,255,255,0.02);
      font-family: Inter, 'Segoe UI', Roboto, Helvetica, Arial, monospace;
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:radial-gradient(circle at 10% 10%, #001200 0%, #000 40%),var(--bg);color:var(--neon);}

    /* canvas background */
    #bgcanvas{position:fixed;inset:0;z-index:0;pointer-events:none}

    .wrap{position:relative;z-index:2;max-width:1180px;margin:36px auto;padding:20px}

    header{display:flex;gap:18px;align-items:center}
    .logo{width:86px;height:86px;border-radius:18px;background:linear-gradient(135deg,#002200,#003900);display:flex;align-items:center;justify-content:center;color:#eaffea;font-weight:900;font-size:30px;box-shadow:0 0 30px rgba(57,255,20,0.18)}

    h1{margin:0;font-size:34px}
    p.lead{margin:4px 0 0;color:var(--muted)}

    nav{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap}
    nav a{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:8px 12px;border-radius:999px;border:1px solid rgba(10,40,10,0.6);text-decoration:none;color:var(--neon);font-weight:700}

    .hero{margin-top:18px;padding:18px;border-radius:16px;background:linear-gradient(180deg,rgba(0,20,0,0.6),rgba(0,0,0,0.65));border:1px solid rgba(10,40,10,0.6);box-shadow:0 8px 50px rgba(0,0,0,0.6);}
    .hero h2{margin:0;font-size:24px}

    .grid{display:grid;grid-template-columns:1fr 360px;gap:20px;margin-top:20px}
    .card{background:linear-gradient(180deg,#050704,#020301);border-radius:12px;padding:14px;border:1px solid rgba(15,40,15,0.5);}

    textarea{width:100%;height:220px;background:#030602;border-radius:10px;border:1px solid rgba(10,30,10,0.7);padding:12px;color:var(--neon);font-family:monospace;font-size:14px}
    .controls{display:flex;gap:8px;margin-top:10px}
    .btn{background:transparent;border:1px solid rgba(10,40,10,0.6);padding:8px 12px;border-radius:10px;color:var(--neon);font-weight:800;cursor:pointer}
    .btn:active{transform:translateY(1px)}

    .output{margin-top:12px;height:200px;overflow:auto;background:#000;border-radius:10px;padding:12px;border:1px solid rgba(10,30,10,0.7)}

    .docs pre{background:#010801;padding:10px;border-radius:8px;border:1px solid rgba(10,30,10,0.7);}

    .fancy-title{display:inline-block;padding:6px 12px;border-radius:999px;background:linear-gradient(90deg,rgba(57,255,20,0.06),rgba(0,255,160,0.02));border:1px solid rgba(57,255,20,0.08);}

    .status-pill{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(0,255,120,0.06);border:1px solid rgba(0,255,120,0.12);color:var(--neon-2);font-weight:800}

    footer{margin-top:26px;color:var(--muted);text-align:center}

    /* neon flicker */
    .neon{color:var(--neon);text-shadow:0 0 8px rgba(57,255,20,0.12),0 0 20px rgba(57,255,20,0.06)}

    @media (max-width:980px){.grid{grid-template-columns:1fr}.wrap{padding:14px;margin:14px auto}}
  </style>
</head>
<body>
  <canvas id="bgcanvas"></canvas>
  <div class="wrap">

    <header>
      <div class="logo">NB</div>
      <div>
        <h1 class="neon">NeonBasic</h1>
        <p class="lead">Dark neon playground — docs, live interpreter, share/save and wild animations.</p>
        <nav>
          <a href="#play">Play</a>
          <a href="#docs">Docs</a>
          <a href="#examples">Examples</a>
          <a href="#share">Share</a>
        </nav>
      </div>
    </header>

    <section class="hero">
      <h2 class="fancy-title">CRAZY MODE — ALWAYS ON</h2>
      <div style="margin-top:12px;display:flex;justify-content:space-between;gap:12px;align-items:center">
        <div>
        <div style="color:var(--muted)">Tip: Use Save/Share to persist your code.</div>
      </div>
    </section>

    <div class="grid">

      <main class="card" id="play">
        <h3>Playground</h3>
        <textarea id="code">REM NeonBasic crazy example
10 VAR A 5
20 IF A > 3 THEN PRINT "A > 3"
30 PRINT "Hello, NeonBasic!"
40 GOTO 60
50 PRINT "This will be skipped"
60 PRINT "End of demo"</textarea>

        <div class="controls">
          <button class="btn" id="run">Run</button>
          <button class="btn" id="stop">Stop</button>
          <button class="btn" id="save">Save</button>
          <button class="btn" id="load">Load</button>
          <button class="btn" id="shareBtn">Share</button>
        </div>

        <div class="output" id="output" aria-live="polite"></div>
      </main>

      <aside class="card docs" id="docs">
        <h3>Docs — Commands</h3>
        <pre>
LINE NUMBERS: optional numeric labels at line start (e.g. 10 PRINT "x")
PRINT "text"      - prints text
VAR <name> <num>  - set numeric variable
IF <var> <op> <num> THEN PRINT "text"  - conditional
GOTO <line>      - jump to labeled line
REM ...           - comment
INPUT <var>       - ask user for input (prompt)
        </pre>

        <h4>Notes</h4>
        <ul>
          <li>Line numbers make GOTO work reliably.</li>
          <li>Variables are numeric; undefined vars default to 0.</li>
          <li>Use simple comparisons: &gt; &lt; == =</li>
        </ul>

        <h3 id="examples">Examples</h3>
        <pre>
REM Counter example
10 VAR I 1
20 PRINT "I = "
30 PRINT "I"
40 VAR I 2
50 GOTO 30
        </pre>

        <h3 id="share">Share & Save</h3>
        <p>Save stores code in your browser. Share generates a short link via URL hash that you can paste to anyone.</p>
      </aside>

    </div>

    <section class="card" style="margin-top:18px">
      <h3>Extras</h3>
      <p>Animations: neon particles, animated scanlines and occasional flicker are permanently enabled for the full NeonBasic experience.</p>
    </section>

    <footer>NeonBasic • dark neon UI • Made for fun</footer>
  </div>

  <script>
    // ---------------------------
    // Background canvas (particles + grid + scanlines)
    // Crazy Mode: ALWAYS ON
    // ---------------------------
    const canvas = document.getElementById('bgcanvas');
    const ctx = canvas.getContext('2d');
    let W = canvas.width = innerWidth;
    let H = canvas.height = innerHeight;
    let particles = [];
    // Force animations on
    let animOn = true;

    function rand(min,max){return Math.random()*(max-min)+min}

    function initParticles(){
      particles = [];
      for(let i=0;i<160;i++) particles.push({x:rand(0,W),y:rand(0,H),r:rand(0.3,1.8),v:rand(0.1,0.6)});
    }

    function drawBG(t){
      ctx.clearRect(0,0,W,H);
      const g = ctx.createRadialGradient(W*0.2,H*0.1,10,W*0.5,H*0.5,Math.max(W,H));
      g.addColorStop(0,'rgba(0,40,6,0.12)');g.addColorStop(1,'rgba(0,0,0,0)');
      ctx.fillStyle=g;ctx.fillRect(0,0,W,H);

      for(const p of particles){
        p.y -= p.v + Math.sin((t+p.x)*0.002)*0.2;
        if(p.y<-10) p.y=H+10;
        ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
        ctx.fillStyle='rgba(57,255,20,0.07)';ctx.fill();
      }

      ctx.strokeStyle='rgba(0,255,140,0.03)';
      ctx.lineWidth=1;
      for(let x=0;x<W;x+=80){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,H);ctx.stroke();}
      for(let y=0;y<H;y+=80){ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(W,y);ctx.stroke();}

      ctx.fillStyle='rgba(0,0,0,0.04)';
      for(let y=0;y<H;y+=3) ctx.fillRect(0,y,W,1);

      if(Math.random()<0.008){
        const x=rand(0,W), y=rand(0,H), r=rand(60,180);
        const grad=ctx.createRadialGradient(x,y,1,x,y,r);
        grad.addColorStop(0,'rgba(57,255,20,0.06)');grad.addColorStop(1,'rgba(57,255,20,0)');
        ctx.fillStyle=grad;ctx.beginPath();ctx.arc(x,y,r,0,Math.PI*2);ctx.fill();
      }
    }

    function loop(t){
      if(animOn) drawBG(t);
      requestAnimationFrame(loop);
    }

    addEventListener('resize',()=>{W=canvas.width=innerWidth;H=canvas.height=innerHeight;initParticles();});
    initParticles();requestAnimationFrame(loop);

    // ---------------------------
    // Simple interpreter with line numbers and GOTO & INPUT
    // ---------------------------
    const codeEl = document.getElementById('code');
    const out = document.getElementById('output');
    const runBtn = document.getElementById('run');
    const stopBtn = document.getElementById('stop');
    const saveBtn = document.getElementById('save');
    const loadBtn = document.getElementById('load');
    const shareBtn = document.getElementById('shareBtn');

    let running = false;

    function println(t){ const d=document.createElement('div'); d.textContent=t; out.appendChild(d); out.scrollTop=out.scrollHeight; }

    function parseLines(src){
      const lines = src.split('\n').map(l=>l.replace(/\r/g,'')).map(l=>l.trim()).filter(l=>l.length>0);
      const program=[];
      for(const l of lines){
        const m = l.match(/^\s*(\d+)\s+(.*)$/);
        if(m) program.push({num:Number(m[1]),text:m[2]});
        else program.push({num:null,text:l});
      }
      return program;
    }

    async function runProgram(src){
      running = true; out.innerHTML='';
      const prog = parseLines(src);
      const labelIndex = {};
      prog.forEach((ln,i)=>{ if(ln.num!==null) labelIndex[ln.num]=i; });

      let pc = 0;
      while(running && pc < prog.length){
        const raw = prog[pc].text.trim();
        if(/^REM\b/i.test(raw)){ pc++; continue; }

        let m;
        if(m=raw.match(/^INPUT\s+(\w+)$/i)){
          const name = m[1].toUpperCase();
          const val = prompt('INPUT ' + name + ':') || '0';
          window.__neon_vars = window.__neon_vars || {};
          window.__neon_vars[name] = Number(val);
          pc++; continue;
        }

        if(m = raw.match(/^VAR\s+(\w+)\s+(-?\d+)$/i)){
          window.__neon_vars = window.__neon_vars || {};
          window.__neon_vars[m[1].toUpperCase()] = Number(m[2]); pc++; continue;
        }

        if(m = raw.match(/^PRINT\s+"([\s\S]*)"$/i)){
          println(m[1]); pc++; continue;
        }
        if(m = raw.match(/^PRINT\s+(\w+)$/i)){
          const name = m[1].toUpperCase(); const v = (window.__neon_vars && window.__neon_vars[name]) || 0; println(String(v)); pc++; continue;
        }

        if(m = raw.match(/^IF\s+(\w+)\s*(==|=|>|<|>=|<=)\s*(-?\d+)\s+THEN\s+PRINT\s+"([\s\S]*)"$/i)){
          const name=m[1].toUpperCase(); const op=m[2]; const val=Number(m[3]); const msg=m[4];
          const left = (window.__neon_vars && window.__neon_vars[name]) || 0;
          let ok=false;
          if(op=='>') ok = left>val; else if(op=='<') ok = left<val; else if(op=='=='||op=='=') ok = left==val; else if(op=='>=') ok = left>=val; else if(op=='<=') ok = left<=val;
          if(ok) println(msg);
          pc++; continue;
        }

        if(m = raw.match(/^GOTO\s+(\d+)$/i)){
          const target = Number(m[1]);
          if(labelIndex[target] !== undefined) { pc = labelIndex[target]; continue; }
          else { println('Runtime error: unknown label ' + target); break; }
        }

        println('Error: unknown command -> ' + raw);
        pc++;
        await new Promise(r=>setTimeout(r,0));
      }
      running=false;
    }

    runBtn.addEventListener('click',()=>{ runProgram(codeEl.value); });
    stopBtn.addEventListener('click',()=>{ running=false; });

    saveBtn.addEventListener('click',()=>{
      localStorage.setItem('neon_code', codeEl.value); alert('Saved locally');
    });
    loadBtn.addEventListener('click',()=>{
      const v = localStorage.getItem('neon_code'); if(v){ codeEl.value = v; alert('Loaded'); } else alert('No saved code');
    });

    function compressToHash(s){ try{ return encodeURIComponent(btoa(unescape(encodeURIComponent(s)))); }catch(e){return '';} }
    function expandFromHash(h){ try{ return decodeURIComponent(escape(atob(decodeURIComponent(h)))); }catch(e){return ''; } }

    shareBtn.addEventListener('click',()=>{
      const h = compressToHash(codeEl.value);
      const url = location.origin + location.pathname + '#code=' + h;
      navigator.clipboard?.writeText(url).then(()=>{ alert('Share link copied to clipboard'); }).catch(()=>{ prompt('Share link', url); });
    });

    (function(){
      const q = location.hash.replace(/^#?/,'');
      if(q.startsWith('code=')){
        const payload = q.slice(5);
        const txt = expandFromHash(payload); if(txt) codeEl.value = txt;
      }
    })();

    // Darken button
    const darkenBtn = document.getElementById('darken');
    darkenBtn.addEventListener('click', ()=>{ document.body.style.filter = document.body.style.filter?'':'brightness(.85) contrast(.95)'; });

    // small helper: enable crazy flicker occasionally
    (function flickerLoop(){
      if(Math.random()<0.06){ document.querySelectorAll('.neon').forEach(el=>el.style.opacity=0.9); setTimeout(()=>document.querySelectorAll('.neon').forEach(el=>el.style.opacity=1),120); }
      setTimeout(flickerLoop, 800 + Math.random()*1200);
    })();
  </script>
</body>
</html>
